<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Breast Cancer Risk Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    label { display: block; margin-top: 10px; }
    input[type="number"], input[type="checkbox"] { margin-top: 5px; }
    .output { margin-top: 20px; font-weight: bold; }
    .low { color: green; }
    .moderate { color: orange; }
    .high { color: red; }
    .modifiers { margin-top: 20px; display: none; }
    .modifiers label { font-weight: normal; display: block; margin: 5px 0; }
    button.toggle-btn { margin-top: 15px; }
  </style>
</head>
<body>
  <h1>üéì Breast Cancer Risk Workshop Tool</h1>
  <form id="riskForm">
    <label>Age: <input type="number" id="age" value="56"></label>
    <label>Height (inches): <input type="number" id="height" value="64"></label>
    <label>Weight (lbs): <input type="number" id="weight" value="160"></label>
    <label>A1C (HbA1c %): <input type="number" id="a1c" step="0.1" value="5.4"></label>
    <label>Systolic Blood Pressure: <input type="number" id="bp" value="115"></label>
    <label>Vitamin D (ng/mL): <input type="number" id="vitd" step="0.1" value="72"></label>
    <label>Age at Menarche: <input type="number" id="menarche" value="13"></label>
    <label>Alcohol Drinks per Week: <input type="number" id="alcohol" value="7"></label>
    <label>Depression Score (PHQ-9 total): <input type="number" id="depression" value="5"></label>
    <label><input type="checkbox" id="dense"> Dense Breasts</label>
    <label><input type="checkbox" id="family"> First-Degree Relative with Breast Cancer</label>
    <label><input type="checkbox" id="nulliparous"> Nulliparous (never given birth)</label>
    <label><input type="checkbox" id="hrt"> HRT (Hormone Replacement Therapy) Use</label>
    <label><input type="checkbox" id="brca"> Known BRCA1/BRCA2 Mutation</label>
    <label><input type="checkbox" id="smoking"> Current or Past Smoker</label>

    <button type="button" onclick="calculateRisk()">Calculate Risk</button>
    <button type="button" class="toggle-btn" onclick="toggleModifiers()">‚òëÔ∏è Explore Ways to Lower Your Risk</button>

    <div class="modifiers" id="modifiers">
      <p><strong>Select the lifestyle strategies you currently use:</strong></p>
      <label><input type="checkbox" id="exercise"> Regular physical activity (150 min/week moderate or 75 min vigorous)</label>
      <label><input type="checkbox" id="iodine"> Iodine sufficiency</label>
      <label><input type="checkbox" id="omega3"> Omega-3 intake</label>
      <label><input type="checkbox" id="sulforaphane"> Sulforaphane (broccoli sprouts)</label>
      <label><input type="checkbox" id="antiInflammatoryDiet"> Anti-inflammatory diet (e.g., Mediterranean diet with EVOO)</label>
      <label><input type="checkbox" id="nonSmoker"> Lifelong non-smoker</label>
      <label><input type="checkbox" id="vitD"> Vitamin D level between 50‚Äì80 ng/mL</label>
    </div>
  </form>

  <div class="output" id="result"></div>

  <script>
    function toggleModifiers() {
      const section = document.getElementById('modifiers');
      section.style.display = section.style.display === 'none' ? 'block' : 'none';
    }

    function calculateRisk() {
      let score = 0;
      let riskReduction = 0;

      const height = parseFloat(document.getElementById('height').value);
      const weight = parseFloat(document.getElementById('weight').value);
      const bmi = (weight / (height * height)) * 703;

      const a1c = parseFloat(document.getElementById('a1c').value);
      const bp = parseInt(document.getElementById('bp').value);
      const vitd = parseFloat(document.getElementById('vitd').value);
      const depression = parseInt(document.getElementById('depression').value);
      const alcohol = parseInt(document.getElementById('alcohol').value);
      const menarche = parseInt(document.getElementById('menarche').value);

      const dense = document.getElementById('dense').checked;
      const family = document.getElementById('family').checked;
      const nulliparous = document.getElementById('nulliparous').checked;
      const hrt = document.getElementById('hrt').checked;
      const brca = document.getElementById('brca').checked;
      const smoking = document.getElementById('smoking').checked;

      if (bmi >= 30) score += 2.5;
      else if (bmi >= 25) score += 1.5;
      else if (bmi < 18.5) score += 0.5;

      if (a1c >= 6.5) score += 2.0;
      else if (a1c >= 5.7) score += 1.0;

      if (bp >= 140) score += 1.0;
      else if (bp >= 120) score += 0.5;

      if (vitd < 20) score += 1.5;
      else if (vitd < 30) score += 0.5;

      if (depression >= 15) score += 0.5;

      if (dense) score += 2.0;
      if (family) score += 2.0;
      if (nulliparous) score += 1.0;
      if (hrt) score += 1.5;
      if (brca) score += 3.0;
      if (smoking) score += 1.0;
      if (menarche < 12) score += 1.0;

      if (alcohol > 0) score += 0.1 * alcohol;

      // Modifiable risk factor reductions
      if (document.getElementById('exercise').checked) riskReduction += 0.20;
      if (document.getElementById('iodine').checked) riskReduction += 0.05;
      if (document.getElementById('omega3').checked) riskReduction += 0.07;
      if (document.getElementById('sulforaphane').checked) riskReduction += 0.07;
      if (document.getElementById('antiInflammatoryDiet').checked) riskReduction += 0.10;
      if (document.getElementById('nonSmoker').checked) riskReduction += 0.05;
      if (document.getElementById('vitD').checked) riskReduction += 0.25;

      if (score > 10) score = 10;

      let baseRisk = 10;
      if (score <= 2.0) baseRisk = 10;
      else if (score <= 4.0) baseRisk = 15;
      else if (score <= 6.0) baseRisk = 20;
      else if (score <= 8.0) baseRisk = 30;
      else baseRisk = 40;

      let adjustedRisk = baseRisk * (1 - riskReduction);
      if (adjustedRisk < 5) adjustedRisk = 5;

      let riskClass = 'low';
      if (adjustedRisk >= 20 && adjustedRisk < 30) riskClass = 'moderate';
      else if (adjustedRisk >= 30) riskClass = 'high';

      document.getElementById('result').innerHTML = `
        Relative Risk Score: <strong>${score.toFixed(1)} / 10</strong><br>
        Adjusted Estimated Lifetime Breast Cancer Risk: <strong class="${riskClass}">${adjustedRisk.toFixed(1)}%</strong><br>
        <p>This estimate reflects your individual health and lifestyle inputs. Curious how to reduce your risk? Click the button above and select actions you already take.</p>
      `;
    }
  </script>
</body>
</html>
